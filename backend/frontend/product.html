<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><title>Product - G Mart</title><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"></head><body class="bg-gray-50 text-gray-800"><header class="bg-green-700 text-white p-4"><div class="container mx-auto"><a href="/products.html">Products</a></div></header><main class="container mx-auto py-8"><div id="detail"></div></main><script>async function load(){const params=new URLSearchParams(location.search);const id=params.get('id');if(!id){document.getElementById('detail').innerText='No product selected';return;}const res=await fetch('/api/products/'+id);if(!res.ok){document.getElementById('detail').innerText='Product not found';return;}const p=await res.json();document.getElementById('detail').innerHTML=`<div class='grid md:grid-cols-3 gap-6'><div class='col-span-1 bg-white p-4 rounded shadow'><div class='h-64 bg-gray-100 flex items-center justify-center'>Image</div></div><div class='md:col-span-2'><h2 class='text-2xl font-bold mb-2'>${p.name}</h2><p class='mb-4'>${p.description||''}</p><p class='text-green-700 font-bold text-xl mb-4'>$${(p.price/100).toFixed(2)}</p><div><input id='qty' type='number' value='1' min='1' class='w-20 p-2 border rounded' /><button onclick='addToCart("${p._id}", Number(document.getElementById("qty").value||1))' class='bg-green-700 text-white px-4 py-2 rounded ml-3'>Add to Cart</button><button onclick='buyNow("${p._id}")' class='bg-blue-600 text-white px-4 py-2 rounded ml-3'>Buy Now (PayPal)</button></div></div></div>`;}window.addToCart=function(id,qty=1){const cart=JSON.parse(localStorage.getItem('gcart')||'[]');const found=cart.find(i=>i.id===id);if(found) found.qty+=qty; else cart.push({id,qty});localStorage.setItem('gcart',JSON.stringify(cart));alert('Added to cart');};async function buyNow(id){const qty=Number(document.getElementById('qty').value||1);const res=await fetch('/api/create-paypal-order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({items:[{id,qty}], customer:{email:prompt('Enter email for receipt')}})});const data=await res.json();if(data && data.id){const script=document.createElement('script'); script.src=`https://www.paypal.com/sdk/js?client-id=REPLACE_WITH_YOUR_PAYPAL_CLIENT_ID&currency=USD`; document.body.appendChild(script); script.onload=()=>{paypal.Buttons({createOrder:()=>data.id,onApprove: async (dataApp)=>{const cap=await fetch('/api/capture-paypal-order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({orderID:dataApp.orderID})});const json=await cap.json();alert('Payment successful');location.href='/';}}).render('body');};} }</script></body></html>